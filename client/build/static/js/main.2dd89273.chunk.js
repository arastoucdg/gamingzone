(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{27:function(e,t,n){},28:function(e,t,n){},50:function(e,t,n){"use strict";n.r(t);var s=n(1),r=n.n(s),c=n(21),a=n.n(c),o=(n(27),n(3)),i=(n(28),n(29),n(4)),l=n(2),j=n(8),u=n(5),b=n.n(u),d=n(22),m=n.n(d).a.create();m.defaults.baseURL="http://localhost:3001",m.defaults.headers.post["Content-Type"]="application/json",m.defaults.withCredentials=!0,m.interceptors.request.use((function(e){return console.log("A request has been made"),e}),(function(e){return Promise.reject(e)})),m.interceptors.response.use((function(e){return console.log("A respones has been received"),e}),(function(e){return console.log("Error response has been received",e.response),401===e.response.status&&(console.log("We hit 401, token must not be valid"),window.location="/logout"),Promise.reject(e)}));var p=m,h=n(0);function O(e){var t=e.children;return Object(h.jsx)("div",{className:"auth-wrapper",children:Object(h.jsx)("div",{className:"auth-inner",children:t})})}function x(e){var t=e.isVisible,n=e.errorMessage;return Object(h.jsx)(h.Fragment,{children:t?Object(h.jsx)(h.Fragment,{children:Object(h.jsx)("p",{className:"error-message",children:n})}):null})}function g(){var e=Object(l.g)(),t=Object(s.useContext)(E).handleLogin,n=Object(s.useState)(!1),r=Object(o.a)(n,2),c=r[0],a=r[1],i=Object(s.useState)(""),u=Object(o.a)(i,2),d=u[0],m=u[1],g=function(){var n=Object(j.a)(b.a.mark((function n(s){var r,c,o;return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return s.preventDefault(),r=new FormData(s.target),c={email:r.get("email"),password:r.get("password")},n.prev=3,n.next=6,p.post("/users/login",c);case 6:o=n.sent,t(o.data.user.username),e("/list-users"),n.next=16;break;case 11:n.prev=11,n.t0=n.catch(3),console.log(n.t0),a(!0),m(n.t0.response.data.message);case 16:case"end":return n.stop()}}),n,null,[[3,11]])})));return function(e){return n.apply(this,arguments)}}();return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)(O,{children:[Object(h.jsx)("h1",{children:"Login"}),Object(h.jsxs)("form",{onSubmit:g,children:[Object(h.jsxs)("label",{children:["Email",Object(h.jsx)("input",{name:"email",type:"email",required:!0})]}),Object(h.jsxs)("label",{children:["Password",Object(h.jsx)("input",{name:"password",type:"password",required:!0})]}),Object(h.jsx)(x,{isVisible:c,errorMessage:d}),Object(h.jsx)("button",{children:"Login"})]})]})})}function f(){var e=Object(l.g)(),t=Object(s.useContext)(E).handleLogin;return Object(s.useEffect)((function(){function n(){return(n=Object(j.a)(b.a.mark((function n(){return b.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.next=2,p.get("/users/logout");case 2:t(""),e("/");case 4:case"end":return n.stop()}}),n)})))).apply(this,arguments)}setTimeout((function(){!function(){n.apply(this,arguments)}()}),500)}),[]),Object(h.jsx)("h1",{children:"You are currently being logged out..."})}function v(){var e=Object(s.useState)([]),t=Object(o.a)(e,2),n=t[0],r=t[1],c=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,p.get("/users/list");case 2:t=e.sent,r(t.data.users);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){c()}),[]),Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h1",{children:"welcome..!"}),n.map((function(e){return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("p",{children:[e.email,", ",e.firstname]})})}))]})}function w(){var e=Object(s.useContext)(E).username;return Object(h.jsx)(h.Fragment,{children:Object(h.jsxs)("h1",{children:["Welcome back, ",e]})})}var N=function(e){var t=e.children;return e.auth?t:Object(h.jsx)(l.a,{to:"/login"})};function y(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(i.b,{className:"btn btn-outline-info me-md-2",to:"/login",children:"Login"}),Object(h.jsx)(i.b,{className:"btn btn-outline-primary",to:"/register",children:"Signup"})]})}function S(){return Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(i.b,{className:"p-2 text-dark",to:"/list-users",children:"List"}),Object(h.jsx)(i.b,{className:"p-2 text-dark",to:"/profile",children:"My Profile"}),Object(h.jsx)(i.b,{className:"btn btn-outline-primary btn-sm",to:"/logout",children:"Logout"})]})}function k(e){var t=e.loggedIn;return Object(h.jsxs)("div",{className:"d-flex flex-column flex-md-row align-items-center justify-content-between p-3 px-md-4 mb-3 bg-white border-bottom shadow-sm",children:[Object(h.jsx)("h5",{className:"my-0 mr-md-auto font-weight-normal",children:"Dinoco"}),Object(h.jsxs)("nav",{className:"my-2 my-md-0 me-md-3",children:[Object(h.jsx)(i.b,{className:"p-2 text-dark",to:"/",children:"Home"}),t?Object(h.jsx)(S,{}):Object(h.jsx)(y,{})]})]})}function F(){var e=Object(l.g)(),t=Object(s.useState)(!1),n=Object(o.a)(t,2),r=n[0],c=n[1],a=Object(s.useState)(""),u=Object(o.a)(a,2),d=u[0],m=u[1],g=function(){var t=Object(j.a)(b.a.mark((function t(n){var s,r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),console.log("Submit the form"),s=new FormData(n.target),r={firstname:s.get("firstname"),lastname:s.get("lastname"),username:s.get("username"),email:s.get("email"),password:s.get("password")},console.log(r),t.prev=5,t.next=8,p.post("/users/register",r);case 8:200===t.sent.status&&(console.log("user was created"),e("/login")),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(5),console.log(t.t0),c(!0),m(t.t0.response.data.message);case 17:case"end":return t.stop()}}),t,null,[[5,12]])})));return function(e){return t.apply(this,arguments)}}();return Object(h.jsx)(O,{children:Object(h.jsxs)("form",{onSubmit:g,children:[Object(h.jsx)("h3",{children:"Sign Up"}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"First name"}),Object(h.jsx)("input",{type:"text",name:"firstname",className:"form-control",placeholder:"First name"})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Last name"}),Object(h.jsx)("input",{type:"text",name:"lastname",className:"form-control",placeholder:"Last name"})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Username"}),Object(h.jsx)("input",{type:"text",name:"username",className:"form-control",placeholder:"Username"})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Email address"}),Object(h.jsx)("input",{type:"email",name:"email",className:"form-control",placeholder:"Enter email"})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Password"}),Object(h.jsx)("input",{type:"password",name:"password",className:"form-control",placeholder:"Enter password"})]}),Object(h.jsxs)("div",{className:"form-group",children:[Object(h.jsx)("label",{children:"Re-Password"}),Object(h.jsx)("input",{type:"password",name:"repassword",className:"form-control",placeholder:"Enter password"})]}),Object(h.jsx)(x,{isVisible:r,errorMessage:d}),Object(h.jsx)("button",{className:"btn btn-primary mt-3 btn-block",children:"Sign Up"}),Object(h.jsxs)("p",{className:"forgot-password text-right",children:["Already registered ",Object(h.jsx)(i.b,{to:"/login",children:"sign in?"})]})]})})}function L(){var e=Object(s.useState)(null),t=Object(o.a)(e,2),n=t[0],r=t[1],c=function(){var e=Object(j.a)(b.a.mark((function e(){var t;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p.get("/users/profile");case 3:200===(t=e.sent).status&&r(t.data.user),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}();return Object(s.useEffect)((function(){c()}),[]),Object(h.jsx)(h.Fragment,{children:null!=n?Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)("h1",{children:n._id}),Object(h.jsxs)("h1",{children:[n.firstname," ",n.lastname]}),Object(h.jsx)("h3",{children:n.username}),Object(h.jsx)("h4",{children:n.email})]}):Object(h.jsx)("p",{children:"No user found"})})}var E=Object(s.createContext)({username:"",loggedIn:!1,handleLogin:function(){}});var I=function(){var e=JSON.parse(sessionStorage.getItem("login"))||{username:"",loggedIn:!1},t=Object(s.useState)(e.username),n=Object(o.a)(t,2),r=n[0],c=n[1],a=Object(s.useState)(e.loggedIn),j=Object(o.a)(a,2),u=j[0],b=j[1];return Object(s.useEffect)((function(){sessionStorage.setItem("login",JSON.stringify({username:r,loggedIn:u}))}),[r,u]),Object(h.jsx)(E.Provider,{value:{username:r,loggedIn:u,handleLogin:function(e){e?(c(e),b(!0)):(c(""),b(!1))}},children:Object(h.jsx)("div",{className:"App",children:Object(h.jsxs)(i.a,{children:[Object(h.jsx)(k,{loggedIn:u}),Object(h.jsxs)(l.d,{children:[Object(h.jsx)(l.b,{path:"/",element:Object(h.jsx)(w,{})}),Object(h.jsx)(l.b,{path:"/login",element:Object(h.jsx)(g,{})}),Object(h.jsx)(l.b,{path:"/register",element:Object(h.jsx)(F,{})}),Object(h.jsx)(l.b,{path:"/logout",element:Object(h.jsx)(f,{})}),Object(h.jsx)(l.b,{path:"/list-users",element:Object(h.jsx)(N,{auth:u,children:Object(h.jsx)(v,{})})}),Object(h.jsx)(l.b,{path:"/profile",element:Object(h.jsx)(N,{auth:u,children:Object(h.jsx)(L,{})})})]})]})})})};a.a.render(Object(h.jsx)(r.a.StrictMode,{children:Object(h.jsx)(I,{})}),document.getElementById("root"))}},[[50,1,2]]]);
//# sourceMappingURL=main.2dd89273.chunk.js.map